<div class="protego-page-container protego-methods">
    <h1>KNNADWIN</h1>
    <p>An adaptive K-Nearest Neighbors classifier.</p>

    <h2 class="protego-bottom-border">Parameters</h2>
    <ul>
        <li><strong>n_neighbors : int, default=5</strong></li>
        <p>The number of nearest neighbors to search for.</p>

        <li><strong>window_size : int, default=1000</strong></li>
        <p>The maximum size of the window storing the last viewed samples.</p>

        <li><strong>leaf_size : int, default=30</strong></li>
        <p>The maximum number of samples that can be stored in one leaf node, which determines from which point the algorithm will switch for a brute-force approach. The bigger this number the faster the tree construction time, but the slower the query time will be.</p>

        <li><strong>p : int, default=2</strong></li>
        <p>p-norm value for the Minkowski metric. When <code>p=1</code>, this corresponds to the Manhattan distance, while <code>p=2</code> corresponds to the Euclidean distance. </p>
    </ul>

    <h2 class="protego-bottom-border">Methods</h2>
    <mat-expansion-panel hideToggle class="mat-elevation-z0">
        <mat-expansion-panel-header>
            <mat-panel-title>
                <mat-icon>info</mat-icon>
                <span style="margin-left: 0.5em;">save</span>
            </mat-panel-title>
        </mat-expansion-panel-header>
        <p style="margin: 2em 0;">Save a model as a pickled file.</p>
        <table>
            <tr>
                <th>Parameters:</th>
                <td>
                    <strong>filename: string</strong>
                    <p>Path and filename of pickled model to save.</p>
                </td>
            </tr>
            <tr>
                <th>Returns:</th>
                <td>None</td>
            </tr>
        </table> 
    </mat-expansion-panel>

    <mat-expansion-panel hideToggle class="mat-elevation-z0">
        <mat-expansion-panel-header>
            <mat-panel-title>
                <mat-icon>info</mat-icon>
                <span style="margin-left: 0.5em;">load</span>
            </mat-panel-title>
        </mat-expansion-panel-header>
        <p style="margin: 2em 0;">Load a pickled model.</p>
        <table>
            <tr>
                <th>Parameters:</th>
                <td>
                    <strong>filename: string</strong>
                    <p>Path and filename of pickled model to load.</p>
                </td>
            </tr>
            <tr>
                <th>Returns:</th>
                <td>None</td>
            </tr>
        </table>  
    </mat-expansion-panel>

    <mat-expansion-panel hideToggle class="mat-elevation-z0">
        <mat-expansion-panel-header>
            <mat-panel-title>
                <mat-icon>info</mat-icon>
                <span style="margin-left: 0.5em;">train</span>
            </mat-panel-title>
        </mat-expansion-panel-header>
        <p style="margin: 2em 0;">Train the classifier.</p>
        <table>
            <tr>
                <th>Parameters:</th>
                <td>
                    <strong>train_data: Pandas DataFrame</strong>
                    <p>Samples to use for training classifier.</p>

                    <strong>train_labels: Pandas Series</strong>
                    <p>Training samples labels.</p>
                </td>
            </tr>
            <tr>
                <th>Returns:</th>
                <td>None</td>
            </tr>
        </table> 
    </mat-expansion-panel>

    <mat-expansion-panel hideToggle class="mat-elevation-z0">
        <mat-expansion-panel-header>
            <mat-panel-title>
                <mat-icon>info</mat-icon>
                <span style="margin-left: 0.5em;">predict</span>
            </mat-panel-title>
        </mat-expansion-panel-header>
        <p style="margin: 2em 0;">Predict whether or not samples are benign or malicious.</p>
        <table>
            <tr>
                <th>Parameters:</th>
                <td>
                    <strong>data: Pandas DataFrame</strong>
                    <p>Samples to make predictions on.</p>
                </td>
            </tr>
            <tr>
                <th>Returns:</th>
                <td>Numpy array containing predictions.</td>
            </tr>
        </table>  
    </mat-expansion-panel>

    <h2 class="protego-bottom-border">Examples</h2>
    <div class="protego-editor">
        <button mat-button matTooltip="Toggle Line Numbers" class="protego-editor-btn" (click)="toggleNumbers()"><mat-icon>format_list_numbered</mat-icon></button>
        <span *ngIf="showNumbers" class="protego-ln">&nbsp;1&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="protego-key">from</span> protego.utils.feature_extractor <span class="protego-key">import</span> FeatureExtractor <br>
        <span *ngIf="showNumbers" class="protego-ln">&nbsp;2&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="protego-key">from</span> protego.utils.DataLoader <span class="protego-key">import</span> DataLoader <br>
        <span *ngIf="showNumbers" class="protego-ln">&nbsp;3&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="protego-key">from</span> protego.models.online <span class="protego-key">import</span> KNNADWIN <br>
        <span *ngIf="showNumbers" class="protego-ln">&nbsp;3&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="protego-key">from</span> sklearn.metrics <span class="protego-key">import</span> accuracy_score <br>
        <span *ngIf="showNumbers" class="protego-ln">&nbsp;4&nbsp;&nbsp;&nbsp;&nbsp;</span><br>
        <span *ngIf="showNumbers" class="protego-ln">&nbsp;5&nbsp;&nbsp;&nbsp;&nbsp;</span>data_loader <span class="protego-op">=</span> DataLoader() <br>
        <span *ngIf="showNumbers" class="protego-ln">&nbsp;6&nbsp;&nbsp;&nbsp;&nbsp;</span>dataset = data_loader.load() <br>
        <span *ngIf="showNumbers" class="protego-ln">&nbsp;7&nbsp;&nbsp;&nbsp;&nbsp;</span><br>
        <span *ngIf="showNumbers" class="protego-ln">&nbsp;8&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="protego-comment"># Split into train/test sets</span><br>
        <span *ngIf="showNumbers" class="protego-ln">&nbsp;9&nbsp;&nbsp;&nbsp;&nbsp;</span>split = <span class="protego-fn">int</span>(<span class="protego-key">len</span>(dataset)*<span class="protego-num">0.8</span>)<br>
        <span *ngIf="showNumbers" class="protego-ln">10&nbsp;&nbsp;&nbsp;&nbsp;</span>train_data = dataset.loc[:split, :]<br>
        <span *ngIf="showNumbers" class="protego-ln">11&nbsp;&nbsp;&nbsp;&nbsp;</span>test_data = dataset.loc[split + <span class="protego-num">1</span>:, :]<br>
        <span *ngIf="showNumbers" class="protego-ln">12&nbsp;&nbsp;&nbsp;&nbsp;</span><br>
        <span *ngIf="showNumbers" class="protego-ln">13&nbsp;&nbsp;&nbsp;&nbsp;</span>fe = FeatureExtractor() <br>
        <span *ngIf="showNumbers" class="protego-ln">14&nbsp;&nbsp;&nbsp;&nbsp;</span>train_data = fe.transform(train_data) <br>
        <span *ngIf="showNumbers" class="protego-ln">15&nbsp;&nbsp;&nbsp;&nbsp;</span>test_data = fe.transform(test_data) <br>
        <span *ngIf="showNumbers" class="protego-ln">16&nbsp;&nbsp;&nbsp;&nbsp;</span><br>
        <span *ngIf="showNumbers" class="protego-ln">17&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="protego-comment"># Process dataset for training/testing</span><br>
        <span *ngIf="showNumbers" class="protego-ln">18&nbsp;&nbsp;&nbsp;&nbsp;</span>features = train_data.columns[:-<span class="protego-num">1</span>]<br>
        <span *ngIf="showNumbers" class="protego-ln">19&nbsp;&nbsp;&nbsp;&nbsp;</span>train_set = train_data[features]<br>
        <span *ngIf="showNumbers" class="protego-ln">20&nbsp;&nbsp;&nbsp;&nbsp;</span>train_lbl = train_data[<span class="protego-str">"label"</span>]<br>
        <span *ngIf="showNumbers" class="protego-ln">21&nbsp;&nbsp;&nbsp;&nbsp;</span>test_set = test_data[features]<br>
        <span *ngIf="showNumbers" class="protego-ln">22&nbsp;&nbsp;&nbsp;&nbsp;</span>test_lbl = test_data[<span class="protego-str">"label"</span>]<br>
        <span *ngIf="showNumbers" class="protego-ln">23&nbsp;&nbsp;&nbsp;&nbsp;</span><br>
        <span *ngIf="showNumbers" class="protego-ln">24&nbsp;&nbsp;&nbsp;&nbsp;</span>clf = KNNADWIN() <br>
        <span *ngIf="showNumbers" class="protego-ln">25&nbsp;&nbsp;&nbsp;&nbsp;</span>clf.train(train_set, train_lbl) <br>
        <span *ngIf="showNumbers" class="protego-ln">26&nbsp;&nbsp;&nbsp;&nbsp;</span>clf.save(<span class="protego-str">"my_model_knno.pkl"</span>) <br>
        <span *ngIf="showNumbers" class="protego-ln">27&nbsp;&nbsp;&nbsp;&nbsp;</span>clf.load(<span class="protego-str">"my_model_knno.pkl"</span>) <br>
        <span *ngIf="showNumbers" class="protego-ln">28&nbsp;&nbsp;&nbsp;&nbsp;</span>y_pred = clf.predict(test_set) <br>
        <span *ngIf="showNumbers" class="protego-ln">29&nbsp;&nbsp;&nbsp;&nbsp;</span>print(<span class="protego-key">f</span><span class="protego-str">"Accuracy:</span> <span class="protego-const">{{ '{' }}</span><span class="protego-num">100</span>*accuracy_score(test_lbl, y_pred)<span class="protego-num">:3.3f</span><span class="protego-const">{{ '}' }}</span><span class="protego-str">%"</span>) <br>
    </div>
</div>