<div class="protego-page-container protego-methods">
    <h1>AdaptiveRandomForest</h1>
    <p>An adaptive random forest classifier.</p>

    <h2 class="protego-bottom-border">Parameters</h2>
    <ul>
        <li><strong>n_models : int, default=10</strong></li>
        <p>Number of trees in the ensemble.</p>

        <li><strong>max_features : Union[bool, str, int], default="sqrt"</strong></li>
        <p>Max number of attributes for each node split.</p>
        <ul style="padding-bottom: 1em;">
            <li>If <code>int</code>, then consider <code>max_features</code> at each split.</li>
            <li>If <code>float</code>, then <code>max_features</code> is a percentage and <code>int(max_features * n_features)</code> features are considered per split.</li>
            <li>If "sqrt", then <code>max_features=sqrt(n_features)</code>.</li>
            <li>If "log2", then <code>max_features=log2(n_features)</code>.</li>
            <li>If None, then <code>max_features=n_features</code>.</li>
        </ul>

        <li><strong>lambda_value : int, default=6</strong></li>
        <p>The lambda value for bagging (lambda=6 corresponds to Leveraging Bagging).</p>

        <li><strong>metric : river.metrics.base.MultiClassMetric, default=Accuracy</strong></li>
        <p>Metric used to track trees performance within the ensemble.</p>

        <li><strong>disable_weighted_vote : bool, default=False</strong></li>
        <p>If <code>True</code>, disables the weighted vote prediction.</p>

        <li><strong>drift_detector : Union[base.DriftDetector, NoneType], default=ADWIN</strong></li>
        <p>Drift Detection method. Set to None to disable Drift detection.</p>

        <li><strong>warning_detector : Union[base.DriftDetector, NoneType], default=ADWIN</strong></li>
        <p>Warning Detection method. Set to None to disable warning detection.</p>

        <li><strong>grace_period : int, default=50</strong></li>
        <p>[Tree parameter] Number of instances a leaf should observe between split attempts.</p>

        <li><strong>max_depth : int, default=100</strong></li>
        <p>[Tree parameter] The maximum depth a tree can reach. If <code>None</code>, the tree will grow indefinitely.</p>

        <li><strong>split_criterion : str, default="info_gain"</strong></li>
        <p>[Tree parameter] Split criterion to use.</p>
        <ul style="margin-bottom: 1em;">
            <li>'gini' - Gini</li>
            <li>'info_gain' - Information Gain</li>
            <li>'hellinger' - Hellinger Distance</li>
        </ul>

        <li><strong>split_confidence : float, default=0.01</strong></li>
        <p>[Tree parameter] Allowed error in split decision, a value closer to 0 takes longer to decide.</p>

        <li><strong>tie_threshold : float, default=0.05</strong></li>
        <p>[Tree parameter] Threshold below which a split will be forced to break ties.</p>

        <li><strong>leaf_prediction : str, default="nba"</strong></li>
        <p>[Tree parameter] Prediction mechanism used at leafs.</p>
        <ul style="margin-bottom: 1em;">
            <li>'mc' - Majority Class</li>
            <li>'nb' - Naive Bayes</li>
            <li>'nba' - Naive Bayes Adaptive</li>
        </ul>

        <li><strong>nb_threshold : int, default=0</strong></li>
        <p>[Tree parameter] Number of instances a leaf should observe before allowing Naive Bayes.</p>

        <li><strong>nominal_attributes : list, default=None</strong></li>
        <p>[Tree parameter] List of Nominal attributes. If empty, then assume that all attributes are numerical.</p>

        <li><strong>splitter : river.tree.splitter.base.Splitter, default=None</strong></li>
        <p>[Tree parameter] The Splitter or Attribute Observer (AO) used to monitor the class statistics of numeric features and perform splits. Splitters are available in the <code>tree.splitter</code> module. Different splitters are available for classification and regression tasks. Classification and regression splitters can be distinguished by their property <code>is_target_class</code>. This is an advanced option. Special care must be taken when choosing different splitters. By default, <code>tree.splitter.GaussianSplitter</code> is used if <code>splitter</code> is <code>None</code>.</p>

        <li><strong>binary_split : bool, default=False</strong></li>
        <p>[Tree parameter] If True, only allow binary splits.</p>

        <li><strong>max_size : int, default=32</strong></li>
        <p>[Tree parameter] Maximum memory (MB) consumed by the tree.</p>

        <li><strong>memory_estimate_period : int, default=2000000</strong></li>
        <p>[Tree parameter] Number of instances between memory consumption checks.</p>

        <li><strong>stop_mem_management : bool, default=False</strong></li>
        <p>[Tree parameter] If True, stop growing as soon as memory limit is hit.</p>

        <li><strong>remove_poor_attrs : bool, default=False</strong></li>
        <p>[Tree parameter] If True, disable poor attributes to reduce memory usage.</p>

        <li><strong>merit_preprune : bool, default=True</strong></li>
        <p>[Tree parameter] If True, enable merit-based tree pre-pruning.</p>

        <li><strong>seed : int, default=None</strong></li>
        <p>If <code>int</code>, <code>seed</code> is used to seed the random number generator; If <code>RandomState</code>, <code>seed</code> is the random number generator; If <code>None</code>, the random number generator is the <code>RandomState</code> instance used by <code>np.random</code>.</p>
    </ul>

    <h2 class="protego-bottom-border">Methods</h2>
    <mat-expansion-panel hideToggle class="mat-elevation-z0">
        <mat-expansion-panel-header>
            <mat-panel-title>
                <mat-icon>info</mat-icon>
                <span style="margin-left: 0.5em;">save</span>
            </mat-panel-title>
        </mat-expansion-panel-header>
        <p style="margin: 2em 0;">Save a model as a pickled file.</p>
        <table>
            <tr>
                <th>Parameters:</th>
                <td>
                    <strong>filename: string</strong>
                    <p>Path and filename of pickled model to save.</p>
                </td>
            </tr>
            <tr>
                <th>Returns:</th>
                <td>None</td>
            </tr>
        </table> 
    </mat-expansion-panel>

    <mat-expansion-panel hideToggle class="mat-elevation-z0">
        <mat-expansion-panel-header>
            <mat-panel-title>
                <mat-icon>info</mat-icon>
                <span style="margin-left: 0.5em;">load</span>
            </mat-panel-title>
        </mat-expansion-panel-header>
        <p style="margin: 2em 0;">Load a pickled model.</p>
        <table>
            <tr>
                <th>Parameters:</th>
                <td>
                    <strong>filename: string</strong>
                    <p>Path and filename of pickled model to load.</p>
                </td>
            </tr>
            <tr>
                <th>Returns:</th>
                <td>None</td>
            </tr>
        </table>  
    </mat-expansion-panel>

    <mat-expansion-panel hideToggle class="mat-elevation-z0">
        <mat-expansion-panel-header>
            <mat-panel-title>
                <mat-icon>info</mat-icon>
                <span style="margin-left: 0.5em;">train</span>
            </mat-panel-title>
        </mat-expansion-panel-header>
        <p style="margin: 2em 0;">Train the classifier.</p>
        <table>
            <tr>
                <th>Parameters:</th>
                <td>
                    <strong>train_data: Pandas DataFrame</strong>
                    <p>Samples to use for training classifier.</p>

                    <strong>train_labels: Pandas Series</strong>
                    <p>Training samples labels.</p>
                </td>
            </tr>
            <tr>
                <th>Returns:</th>
                <td>None</td>
            </tr>
        </table> 
    </mat-expansion-panel>

    <mat-expansion-panel hideToggle class="mat-elevation-z0">
        <mat-expansion-panel-header>
            <mat-panel-title>
                <mat-icon>info</mat-icon>
                <span style="margin-left: 0.5em;">predict</span>
            </mat-panel-title>
        </mat-expansion-panel-header>
        <p style="margin: 2em 0;">Predict whether or not samples are benign or malicious.</p>
        <table>
            <tr>
                <th>Parameters:</th>
                <td>
                    <strong>data: Pandas DataFrame</strong>
                    <p>Samples to make predictions on.</p>
                </td>
            </tr>
            <tr>
                <th>Returns:</th>
                <td>Numpy array containing predictions.</td>
            </tr>
        </table>  
    </mat-expansion-panel>

    <h2 class="protego-bottom-border">Examples</h2>
    <div class="protego-editor">
        <button mat-button matTooltip="Toggle Line Numbers" class="protego-editor-btn" (click)="toggleNumbers()"><mat-icon>format_list_numbered</mat-icon></button>
        <span *ngIf="showNumbers" class="protego-ln">&nbsp;1&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="protego-key">from</span> protego.utils.feature_extractor <span class="protego-key">import</span> FeatureExtractor <br>
        <span *ngIf="showNumbers" class="protego-ln">&nbsp;2&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="protego-key">from</span> protego.utils.DataLoader <span class="protego-key">import</span> DataLoader <br>
        <span *ngIf="showNumbers" class="protego-ln">&nbsp;3&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="protego-key">from</span> protego.models.online <span class="protego-key">import</span> AdaptiveRandomForest <br>
        <span *ngIf="showNumbers" class="protego-ln">&nbsp;3&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="protego-key">from</span> sklearn.metrics <span class="protego-key">import</span> accuracy_score <br>
        <span *ngIf="showNumbers" class="protego-ln">&nbsp;4&nbsp;&nbsp;&nbsp;&nbsp;</span><br>
        <span *ngIf="showNumbers" class="protego-ln">&nbsp;5&nbsp;&nbsp;&nbsp;&nbsp;</span>data_loader <span class="protego-op">=</span> DataLoader() <br>
        <span *ngIf="showNumbers" class="protego-ln">&nbsp;6&nbsp;&nbsp;&nbsp;&nbsp;</span>dataset = data_loader.load() <br>
        <span *ngIf="showNumbers" class="protego-ln">&nbsp;7&nbsp;&nbsp;&nbsp;&nbsp;</span><br>
        <span *ngIf="showNumbers" class="protego-ln">&nbsp;8&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="protego-comment"># Split into train/test sets</span><br>
        <span *ngIf="showNumbers" class="protego-ln">&nbsp;9&nbsp;&nbsp;&nbsp;&nbsp;</span>split = <span class="protego-fn">int</span>(<span class="protego-key">len</span>(dataset)*<span class="protego-num">0.8</span>)<br>
        <span *ngIf="showNumbers" class="protego-ln">10&nbsp;&nbsp;&nbsp;&nbsp;</span>train_data = dataset.loc[:split, :]<br>
        <span *ngIf="showNumbers" class="protego-ln">11&nbsp;&nbsp;&nbsp;&nbsp;</span>test_data = dataset.loc[split + <span class="protego-num">1</span>:, :]<br>
        <span *ngIf="showNumbers" class="protego-ln">12&nbsp;&nbsp;&nbsp;&nbsp;</span><br>
        <span *ngIf="showNumbers" class="protego-ln">13&nbsp;&nbsp;&nbsp;&nbsp;</span>fe = FeatureExtractor() <br>
        <span *ngIf="showNumbers" class="protego-ln">14&nbsp;&nbsp;&nbsp;&nbsp;</span>train_data = fe.transform(train_data) <br>
        <span *ngIf="showNumbers" class="protego-ln">15&nbsp;&nbsp;&nbsp;&nbsp;</span>test_data = fe.transform(test_data) <br>
        <span *ngIf="showNumbers" class="protego-ln">16&nbsp;&nbsp;&nbsp;&nbsp;</span><br>
        <span *ngIf="showNumbers" class="protego-ln">17&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="protego-comment"># Process dataset for training/testing</span><br>
        <span *ngIf="showNumbers" class="protego-ln">18&nbsp;&nbsp;&nbsp;&nbsp;</span>features = train_data.columns[:-<span class="protego-num">1</span>]<br>
        <span *ngIf="showNumbers" class="protego-ln">19&nbsp;&nbsp;&nbsp;&nbsp;</span>train_set = train_data[features]<br>
        <span *ngIf="showNumbers" class="protego-ln">20&nbsp;&nbsp;&nbsp;&nbsp;</span>train_lbl = train_data[<span class="protego-str">"label"</span>]<br>
        <span *ngIf="showNumbers" class="protego-ln">21&nbsp;&nbsp;&nbsp;&nbsp;</span>test_set = test_data[features]<br>
        <span *ngIf="showNumbers" class="protego-ln">22&nbsp;&nbsp;&nbsp;&nbsp;</span>test_lbl = test_data[<span class="protego-str">"label"</span>]<br>
        <span *ngIf="showNumbers" class="protego-ln">23&nbsp;&nbsp;&nbsp;&nbsp;</span><br>
        <span *ngIf="showNumbers" class="protego-ln">24&nbsp;&nbsp;&nbsp;&nbsp;</span>clf = AdaptiveRandomForest() <br>
        <span *ngIf="showNumbers" class="protego-ln">25&nbsp;&nbsp;&nbsp;&nbsp;</span>clf.train(train_set, train_lbl) <br>
        <span *ngIf="showNumbers" class="protego-ln">26&nbsp;&nbsp;&nbsp;&nbsp;</span>clf.save(<span class="protego-str">"my_model_rano.pkl"</span>) <br>
        <span *ngIf="showNumbers" class="protego-ln">27&nbsp;&nbsp;&nbsp;&nbsp;</span>clf.load(<span class="protego-str">"my_model_rano.pkl"</span>) <br>
        <span *ngIf="showNumbers" class="protego-ln">28&nbsp;&nbsp;&nbsp;&nbsp;</span>y_pred = clf.predict(test_set) <br>
        <span *ngIf="showNumbers" class="protego-ln">29&nbsp;&nbsp;&nbsp;&nbsp;</span>print(<span class="protego-key">f</span><span class="protego-str">"Accuracy:</span> <span class="protego-const">{{ '{' }}</span><span class="protego-num">100</span>*accuracy_score(test_lbl, y_pred)<span class="protego-num">:3.3f</span><span class="protego-const">{{ '}' }}</span><span class="protego-str">%"</span>) <br>
    </div>
</div>