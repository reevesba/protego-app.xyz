"use strict";(self.webpackChunkprotego=self.webpackChunkprotego||[]).push([[102],{6102:(D,f,i)=>{i.r(f),i.d(f,{SignupModule:()=>X});var g=i(9808),T=i(406),u=i(1402),a=i(3075),h=i(8951),q=i(5144),U=i(8894),b=i(7182),Z=i(1816),r=i(5e3),F=i(4540),s=i(9224),p=i(7322),S=i(7531),w=i(5245),y=i(3290),C=i(7423),_=i(5899),A=i(4894);function I(t,n){1&t&&(r.TgZ(0,"mat-error")(1,"mat-icon",17),r._uU(2,"error_outline"),r.qZA(),r._uU(3),r.ALo(4,"translate"),r.qZA()),2&t&&(r.xp6(3),r.hij(" ",r.lcZ(4,1,"protego.signup.username.warn1")," "))}function L(t,n){1&t&&(r.TgZ(0,"mat-error")(1,"mat-icon",17),r._uU(2,"error_outline"),r.qZA(),r._uU(3),r.ALo(4,"translate"),r.qZA()),2&t&&(r.xp6(3),r.hij(" ",r.lcZ(4,1,"protego.signup.username.warn2")," "))}function N(t,n){1&t&&(r.TgZ(0,"mat-error")(1,"mat-icon",17),r._uU(2,"error_outline"),r.qZA(),r._uU(3),r.ALo(4,"translate"),r.qZA()),2&t&&(r.xp6(3),r.hij(" ",r.lcZ(4,1,"protego.signup.username.warn3")," "))}function x(t,n){1&t&&(r.TgZ(0,"mat-error")(1,"mat-icon",17),r._uU(2,"error_outline"),r.qZA(),r._uU(3),r.ALo(4,"translate"),r.qZA()),2&t&&(r.xp6(3),r.hij(" ",r.lcZ(4,1,"protego.signup.firstname.warn")," "))}function Y(t,n){1&t&&(r.TgZ(0,"mat-error")(1,"mat-icon",17),r._uU(2,"error_outline"),r.qZA(),r._uU(3),r.ALo(4,"translate"),r.qZA()),2&t&&(r.xp6(3),r.hij(" ",r.lcZ(4,1,"protego.signup.lastname.warn")," "))}function J(t,n){1&t&&(r.TgZ(0,"mat-error")(1,"mat-icon",17),r._uU(2,"error_outline"),r.qZA(),r._uU(3),r.ALo(4,"translate"),r.qZA()),2&t&&(r.xp6(3),r.hij(" ",r.lcZ(4,1,"protego.signup.email.warn1")," "))}function O(t,n){1&t&&(r.TgZ(0,"mat-error")(1,"mat-icon",17),r._uU(2,"error_outline"),r.qZA(),r._uU(3),r.ALo(4,"translate"),r.qZA()),2&t&&(r.xp6(3),r.hij(" ",r.lcZ(4,1,"protego.signup.email.warn2")," "))}function P(t,n){1&t&&(r.TgZ(0,"mat-error")(1,"mat-icon",17),r._uU(2,"error_outline"),r.qZA(),r._uU(3),r.ALo(4,"translate"),r.qZA()),2&t&&(r.xp6(3),r.hij(" ",r.lcZ(4,1,"protego.signup.email.warn3")," "))}function Q(t,n){1&t&&(r.TgZ(0,"mat-error")(1,"mat-icon",17),r._uU(2,"error_outline"),r.qZA(),r._uU(3),r.ALo(4,"translate"),r.qZA()),2&t&&(r.xp6(3),r.hij(" ",r.lcZ(4,1,"protego.signup.password.warn1")," "))}function E(t,n){1&t&&(r.TgZ(0,"mat-error")(1,"mat-icon",17),r._uU(2,"error_outline"),r.qZA(),r._uU(3),r.ALo(4,"translate"),r.qZA()),2&t&&(r.xp6(3),r.hij(" ",r.lcZ(4,1,"protego.signup.password.warn2")," "))}function M(t,n){1&t&&(r.TgZ(0,"mat-error")(1,"mat-icon",17),r._uU(2,"error_outline"),r.qZA(),r._uU(3),r.ALo(4,"translate"),r.qZA()),2&t&&(r.xp6(3),r.hij(" ",r.lcZ(4,1,"protego.signup.confirm.warn1")," "))}function j(t,n){1&t&&(r.TgZ(0,"mat-error")(1,"mat-icon",17),r._uU(2,"error_outline"),r.qZA(),r._uU(3),r.ALo(4,"translate"),r.qZA()),2&t&&(r.xp6(3),r.hij(" ",r.lcZ(4,1,"protego.signup.confirm.warn1")," "))}function k(t,n){1&t&&r._UZ(0,"mat-progress-bar",18)}let V=(()=>{class t{constructor(o,e,m,l,d,H,G){this.authService=o,this.router=e,this.route=m,this.fb=l,this.customValidator=d,this.communicationService=H,this.usersService=G,this.hide1=!0,this.hide2=!0,this.loading=!1,this.submitted=!1,this.siteKey="6Lf57HQaAAAAAPPcEnDe7TO4PVTyUjN1w3qd91EQ",this.recaptchaComplete=!1}ngOnInit(){this.registerForm=this.fb.group({username:["",[a.kI.required,a.kI.maxLength(15)],this.customValidator.userNameValidator.bind(this.customValidator)],first_name:["",[a.kI.required]],last_name:["",[a.kI.required]],email:["",[a.kI.required,a.kI.email],this.customValidator.emailValidator.bind(this.customValidator)],password:["",a.kI.compose([a.kI.required,this.customValidator.patternValidator()])],confirm_password:["",[a.kI.required]]},{validators:this.customValidator.MatchPassword("password","confirm_password")}),this.returnUrl=this.route.snapshot.queryParams.returnUrl||"/"}get registerFormControl(){return this.registerForm.controls}onSubmit(){this.submitted=!0,this.registerForm.valid&&(delete this.registerForm.value.confirm_password,this.user=new b.n(this.registerForm.value),this.user.created_by=this.user.username,this.loading=!0,this.saveUser())}saveUser(){this.authService.createUser(this.user).subscribe({next:o=>{this.userRole=(0,Z.Z)(o.auth_token).role,this.getUserPhoto((0,Z.Z)(o.auth_token).username),this.loading=!1,this.router.navigate([this.returnUrl])},error:o=>console.log(o)})}getUserPhoto(o){this.usersService.getUserPhoto(o).subscribe({next:e=>{this.communicationService.emitChange({username:o,role:this.userRole,profilePhoto:"data:image/gif;base64,"+e})},error:e=>console.log(e)})}resolved(o){this.authService.validateRecaptcha(o).subscribe({next:e=>{e.success&&(this.recaptchaComplete=!0)},error:e=>console.log(e)})}onError(o){console.log("reCAPTCHA error encountered; details:",o)}}return t.\u0275fac=function(o){return new(o||t)(r.Y36(h.e),r.Y36(u.F0),r.Y36(u.gz),r.Y36(a.qu),r.Y36(U.a),r.Y36(F.W),r.Y36(q.f))},t.\u0275cmp=r.Xpm({type:t,selectors:[["signup"]],decls:58,vars:50,consts:[[1,"protego-page-container"],[1,"protego-create-account-form"],[1,"protego-form",3,"formGroup"],[1,"protego-full-width"],["matInput","","type","text","formControlName","username","required","",3,"placeholder"],["align","end"],[4,"ngIf"],["matInput","","type","text","formControlName","first_name","required","",3,"placeholder"],["matInput","","type","text","formControlName","last_name","required","",3,"placeholder"],["matInput","","type","text","formControlName","email","required","",3,"placeholder"],["matInput","","formControlName","password","required","","appPassword","",3,"type","placeholder"],["matSuffix","",2,"cursor","pointer",3,"click"],["matInput","","formControlName","confirm_password","required","",3,"type","placeholder"],[1,"protego-recaptcha"],["errorMode","handled",3,"siteKey","resolved","error"],["type","submit","mat-raised-button","","color","primary",1,"protego-button",3,"disabled","click"],["mode","query",4,"ngIf"],[2,"margin-right","2px"],["mode","query"]],template:function(o,e){1&o&&(r.TgZ(0,"div",0)(1,"mat-card",1)(2,"form",2)(3,"mat-card-title"),r._uU(4),r.ALo(5,"translate"),r.qZA(),r.TgZ(6,"mat-card-content")(7,"mat-form-field",3),r._UZ(8,"input",4),r.ALo(9,"translate"),r.TgZ(10,"mat-hint",5),r._uU(11),r.ALo(12,"translate"),r.qZA(),r.YNc(13,I,5,3,"mat-error",6),r.YNc(14,L,5,3,"mat-error",6),r.YNc(15,N,5,3,"mat-error",6),r.qZA(),r.TgZ(16,"mat-form-field",3),r._UZ(17,"input",7),r.ALo(18,"translate"),r._UZ(19,"mat-hint",5),r.YNc(20,x,5,3,"mat-error",6),r.qZA(),r.TgZ(21,"mat-form-field",3),r._UZ(22,"input",8),r.ALo(23,"translate"),r._UZ(24,"mat-hint",5),r.YNc(25,Y,5,3,"mat-error",6),r.qZA(),r.TgZ(26,"mat-form-field",3),r._UZ(27,"input",9),r.ALo(28,"translate"),r._UZ(29,"mat-hint",5),r.YNc(30,J,5,3,"mat-error",6),r.YNc(31,O,5,3,"mat-error",6),r.YNc(32,P,5,3,"mat-error",6),r.qZA(),r.TgZ(33,"mat-form-field",3),r._UZ(34,"input",10),r.ALo(35,"translate"),r._UZ(36,"mat-hint",5),r.YNc(37,Q,5,3,"mat-error",6),r.YNc(38,E,5,3,"mat-error",6),r.TgZ(39,"mat-icon",11),r.NdJ("click",function(){return e.hide1=!e.hide1}),r._uU(40),r.qZA()(),r.TgZ(41,"mat-form-field",3),r._UZ(42,"input",12),r.ALo(43,"translate"),r._UZ(44,"mat-hint",5),r.YNc(45,M,5,3,"mat-error",6),r.YNc(46,j,5,3,"mat-error",6),r.TgZ(47,"mat-icon",11),r.NdJ("click",function(){return e.hide2=!e.hide2}),r._uU(48),r.qZA()()()(),r.TgZ(49,"div",13)(50,"re-captcha",14),r.NdJ("resolved",function(l){return e.resolved(l)})("error",function(l){return e.onError(l)}),r.qZA()(),r.TgZ(51,"mat-card-actions")(52,"button",15),r.NdJ("click",function(){return e.onSubmit()}),r.ALo(53,"translate"),r._uU(54),r.ALo(55,"translate"),r.qZA()(),r.TgZ(56,"mat-card-footer"),r.YNc(57,k,1,0,"mat-progress-bar",16),r.qZA()()()),2&o&&(r.xp6(2),r.Q6J("formGroup",e.registerForm),r.xp6(2),r.Oqu(r.lcZ(5,30,"protego.signup.create")),r.xp6(4),r.s9C("placeholder",r.lcZ(9,32,"protego.signup.username")),r.xp6(3),r.Oqu(r.lcZ(12,34,"protego.signup.username.hint")),r.xp6(2),r.Q6J("ngIf",(e.registerFormControl.username.touched||e.submitted)&&(null==e.registerFormControl.username.errors?null:e.registerFormControl.username.errors.required)),r.xp6(1),r.Q6J("ngIf",(e.registerFormControl.username.touched||e.submitted)&&(null==e.registerFormControl.username.errors?null:e.registerFormControl.username.errors.userNameNotAvailable)),r.xp6(1),r.Q6J("ngIf",(e.registerFormControl.username.touched||e.submitted)&&(null==e.registerFormControl.username.errors?null:e.registerFormControl.username.errors.maxlength)),r.xp6(2),r.s9C("placeholder",r.lcZ(18,36,"protego.signup.firstname")),r.xp6(3),r.Q6J("ngIf",(e.registerFormControl.first_name.touched||e.submitted)&&(null==e.registerFormControl.first_name.errors?null:e.registerFormControl.first_name.errors.required)),r.xp6(2),r.s9C("placeholder",r.lcZ(23,38,"protego.signup.lastname")),r.xp6(3),r.Q6J("ngIf",(e.registerFormControl.last_name.touched||e.submitted)&&(null==e.registerFormControl.last_name.errors?null:e.registerFormControl.last_name.errors.required)),r.xp6(2),r.s9C("placeholder",r.lcZ(28,40,"protego.signup.email")),r.xp6(3),r.Q6J("ngIf",(e.registerFormControl.email.touched||e.submitted)&&(null==e.registerFormControl.email.errors?null:e.registerFormControl.email.errors.required)),r.xp6(1),r.Q6J("ngIf",(e.registerFormControl.email.touched||e.submitted)&&(null==e.registerFormControl.email.errors?null:e.registerFormControl.email.errors.email)),r.xp6(1),r.Q6J("ngIf",(e.registerFormControl.email.touched||e.submitted)&&(null==e.registerFormControl.email.errors?null:e.registerFormControl.email.errors.emailNotAvailable)),r.xp6(2),r.s9C("placeholder",r.lcZ(35,42,"protego.signup.password")),r.Q6J("type",e.hide1?"password":"text"),r.xp6(3),r.Q6J("ngIf",(e.registerFormControl.password.touched||e.submitted)&&(null==e.registerFormControl.password.errors?null:e.registerFormControl.password.errors.required)),r.xp6(1),r.Q6J("ngIf",(e.registerFormControl.password.touched||e.submitted)&&(null==e.registerFormControl.password.errors?null:e.registerFormControl.password.errors.invalidPassword)),r.xp6(2),r.Oqu(e.hide1?"visibility_off":"visibility"),r.xp6(2),r.s9C("placeholder",r.lcZ(43,44,"protego.signup.confirm")),r.Q6J("type",e.hide2?"password":"text"),r.xp6(3),r.Q6J("ngIf",(e.registerFormControl.confirm_password.touched||e.submitted)&&(null==e.registerFormControl.confirm_password.errors?null:e.registerFormControl.confirm_password.errors.required)),r.xp6(1),r.Q6J("ngIf",(e.registerFormControl.confirm_password.touched||e.submitted)&&(null==e.registerFormControl.confirm_password.errors?null:e.registerFormControl.confirm_password.errors.passwordMismatch)),r.xp6(2),r.Oqu(e.hide2?"visibility_off":"visibility"),r.xp6(2),r.s9C("siteKey",e.siteKey),r.xp6(2),r.Q6J("disabled",!e.registerForm.valid||!e.recaptchaComplete),r.uIk("aria-label",r.lcZ(53,46,"protego.signup.aria")),r.xp6(2),r.Oqu(r.lcZ(55,48,"protego.signup.button")),r.xp6(3),r.Q6J("ngIf",e.loading))},directives:[s.a8,a._Y,a.JL,a.sg,s.n5,s.dn,p.KE,S.Nt,a.Fj,a.JJ,a.u,a.Q7,p.bx,g.O5,p.TO,w.Hw,p.R9,y.wT,s.hq,C.lW,s.rt,_.pW],pipes:[A.X$],styles:['@charset "UTF-8";.protego-page-container[_ngcontent-%COMP%]{width:350px;margin:auto;padding-top:2em;padding-bottom:2em}.protego-create-account-form[_ngcontent-%COMP%]{min-width:150px;max-width:350px;width:100%}.protego-full-width[_ngcontent-%COMP%]{width:100%;padding-bottom:1em}.protego-loading[_ngcontent-%COMP%]{font-size:18pt;width:350px;margin:auto}.protego-loading[_ngcontent-%COMP%]:after{overflow:hidden;display:inline-block;vertical-align:bottom;-webkit-animation:ellipsis steps(4,end) .9s infinite;animation:ellipsis steps(4,end) .9s infinite;content:"\\2026";width:0px}@keyframes ellipsis{to{width:1.25em}}@-webkit-keyframes ellipsis{to{width:1.25em}}.protego-cursor-wait[_ngcontent-%COMP%]{cursor:wait}.protego-recaptcha[_ngcontent-%COMP%]{padding-bottom:1em;padding-left:5px}.protego-button[_ngcontent-%COMP%]{margin-left:1em!important;margin-bottom:1em!important}']}),t})();var v=i(5620),R=i(8128),c=i(6275);function z(t,n){1&t&&(r.TgZ(0,"mat-card")(1,"mat-card-title"),r._uU(2),r.ALo(3,"translate"),r.qZA(),r.TgZ(4,"mat-card-subtitle"),r._uU(5),r.ALo(6,"translate"),r.qZA(),r.TgZ(7,"mat-card-content"),r._uU(8),r.ALo(9,"translate"),r.qZA()()),2&t&&(r.xp6(2),r.Oqu(r.lcZ(3,3,"protego.confirm-email.title")),r.xp6(3),r.Oqu(r.lcZ(6,5,"protego.confirm-email.confirmed")),r.xp6(3),r.Oqu(r.lcZ(9,7,"protego.confirm-email.info")))}function W(t,n){1&t&&r._UZ(0,"mat-progress-bar",5)}function B(t,n){if(1&t&&(r.TgZ(0,"mat-card")(1,"mat-card-title"),r._uU(2),r.ALo(3,"translate"),r.qZA(),r.TgZ(4,"mat-card-subtitle"),r._uU(5),r.ALo(6,"translate"),r.qZA(),r.TgZ(7,"mat-card-content"),r._uU(8),r.ALo(9,"translate"),r.qZA(),r.TgZ(10,"mat-card-actions")(11,"button",3),r.ALo(12,"translate"),r._uU(13),r.ALo(14,"translate"),r.qZA()(),r.TgZ(15,"mat-card-footer"),r.YNc(16,W,1,0,"mat-progress-bar",4),r.qZA()()),2&t){const o=r.oxw();r.xp6(2),r.Oqu(r.lcZ(3,6,"protego.confirm-email.apologies")),r.xp6(3),r.Oqu(r.lcZ(6,8,"protego.confirm-email.error")),r.xp6(3),r.Oqu(r.lcZ(9,10,"protego.confirm-email.detail")),r.xp6(3),r.uIk("aria-label",r.lcZ(12,12,"protego.confirm-email.aria")),r.xp6(2),r.Oqu(r.lcZ(14,14,"protego.confirm-email.resend")),r.xp6(3),r.Q6J("ngIf",o.isLoading)}}const K=[{path:"",component:V,data:{title:"protego.menu.signup"}},{path:"confirm-email/:id",component:(()=>{class t{constructor(o,e,m,l,d){this.store=o,this.ar=e,this.authService=m,this.tokenService=l,this.notificationService=d,this.isLoading=!1}ngOnInit(){this.isConfirmed$=this.store.pipe((0,v.Ys)(c.cS)),this.username=this.tokenService.username,this.isConfirmed$.subscribe({next:o=>this.isConfirmed=o,error:o=>console.log(o)}),this.isConfirmed||this.ar.params.subscribe(o=>{o.id&&this.confirmEmail(o.id)})}confirmEmail(o){this.authService.confirmEmail(o).subscribe({next:()=>{this.authService.refreshToken().subscribe({next:()=>this.isConfirmed=!0,error:e=>console.log(e)})},error:e=>console.log(e)})}resendEmail(){this.isLoading=!0,this.authService.resendEmail(this.username).subscribe({next:()=>{this.notificationService.success("Confirmation Email Sent!"),this.isLoading=!1},error:o=>{console.log(o),this.isLoading=!1}})}}return t.\u0275fac=function(o){return new(o||t)(r.Y36(v.yh),r.Y36(u.gz),r.Y36(h.e),r.Y36(R.B),r.Y36(c.gq))},t.\u0275cmp=r.Xpm({type:t,selectors:[["confirm-email"]],decls:4,vars:2,consts:[[1,"protego-page-wrapper"],[4,"ngIf","ngIfElse"],["elseTemplate",""],["mat-raised-button","","color","primary"],["mode","query",4,"ngIf"],["mode","query"]],template:function(o,e){if(1&o&&(r.TgZ(0,"div",0),r.YNc(1,z,10,9,"mat-card",1),r.YNc(2,B,17,16,"ng-template",null,2,r.W1O),r.qZA()),2&o){const m=r.MAs(3);r.xp6(1),r.Q6J("ngIf",e.isConfirmed)("ngIfElse",m)}},directives:[g.O5,s.a8,s.n5,s.$j,s.dn,s.hq,C.lW,s.rt,_.pW],pipes:[A.X$],styles:[".protego-page-wrapper[_ngcontent-%COMP%]{width:350px;margin:auto;padding-top:1em}"]}),t})(),canActivate:[c.PP],data:{title:"protego.menu.confirm-email"}}];let $=(()=>{class t{}return t.\u0275fac=function(o){return new(o||t)},t.\u0275mod=r.oAB({type:t}),t.\u0275inj=r.cJS({imports:[[u.Bz.forChild(K)],u.Bz]}),t})(),X=(()=>{class t{}return t.\u0275fac=function(o){return new(o||t)},t.\u0275mod=r.oAB({type:t}),t.\u0275inj=r.cJS({imports:[[g.ez,T.m,$]]}),t})()}}]);